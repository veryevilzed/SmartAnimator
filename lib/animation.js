'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _easing=require('./easing.js');var _easing2=_interopRequireDefault(_easing);var _lodash=require('lodash');var _lodash2=_interopRequireDefault(_lodash);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var Animation=function(){function Animation(obj){var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Animation);this.obj=obj;this.params=_lodash2.default.extend({time:1,to:{},from:{},easing:_easing2.default.linear,run:false,autoAdd:true,strings:{}},params);this.run=this.params.run;this.__dt=0;this._from={};this._to={};}_createClass(Animation,[{key:'start',value:function start(){this.__apply(this.params.from);this.__dt=0;this.__prepare();this.__clearSame();this.run=true;return this;}},{key:'stop',value:function stop(){var applyTo=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;this.run=false;if(applyTo){this.__apply(this.params.to);}return this;}},{key:'update',value:function update(dt){var _this=this;this.__dt+=dt;var _dt=this.__dt;if(_dt>this.params.time){_dt=this.params.time;}_lodash2.default.forEach(this._from,function(value,key){if(typeof _this.params.to[key]==='number'){if(_this.params.to[key]!==undefined){_lodash2.default.set(_this.obj,key,_this.params.easing(_dt,value,_this._to[key]-value,_this.params.time));}}else if(_this.__dt>=_this.params.time&&_this.params.to[key]!==undefined){_lodash2.default.set(_this.obj,key,_this.params.to[key]);}});_lodash2.default.forEach(this.params.strings,function(value,key){if(typeof value==='string'){_lodash2.default.set(_this.obj,key,value);}if(typeof value==='function'){_lodash2.default.set(_this.obj,key,value(_this.obj));}});return{stop:this.__dt>=this.params.time,dt:this.__dt-_dt};}},{key:'__getValues',value:function __getValues(obj,params){var result=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return _lodash2.default.reduce(params,function(r,value,key){r[key]=_lodash2.default.get(obj,key);return r;},result);}},{key:'__prepare',value:function __prepare(){this._from=this.__getValues(this.params.from,this.params.from,this.__getValues(this.obj,this.params.to,{}));this._to=this.__getValues(this.params.to,this.params.to,this.__getValues(this.params.from,this.params.from,{}));}},{key:'__clearSame',value:function __clearSame(){var _this2=this;this._to=_lodash2.default.reduce(this._to,function(res,val,key){if(_this2._from[key]===val){return res;}res[key]=val;return res;},{});}},{key:'__apply',value:function __apply(params){var _this3=this;_lodash2.default.forEach(params,function(value,key){return _lodash2.default.set(_this3.obj,key,value);});_lodash2.default.forEach(this.params.strings,function(value,key){if(typeof value==='string'){_lodash2.default.set(_this3.obj,key,value);}if(typeof value==='function'){_lodash2.default.set(_this3.obj,key,value(_this3.obj));}});}}]);return Animation;}();exports.default=Animation;module.exports=exports['default'];